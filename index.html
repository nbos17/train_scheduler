<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Employee</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
  <script src="https://www.gstatic.com/firebasejs/3.7.1/firebase.js"></script>
  <style>
  .formgroup {
    margin: 10px;
  }
  .card {
    margin-bottom: 10px;
  }
</style>
</head>

<body>

<div class="container">
  <div class="jumbotron">
    <h1 class="display-4">Employee Data Management</h1>
    <p class="lead">A Comprehensive Directory of Employee Billable Hours</p>
  </div>

  <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title"><strong>Current Employees</strong></h3>
            </div>
            <div class="panel-body">
              <table class="table table-hover" id='employee-table'>
                <thead>
                  <tr>
                    <th>Employee Name</th>
                    <th>Role</th>
                    <th>Start Date</th>
                    <th>Months Worked</th>
                    <th>Monthly Rate ($)</th>
                    <th>Total Billed ($)</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>


    <div class="card">
      <div class="card-body">
        <form>
        <div class="form-group">
          <label for="exampleInputEmail1">Employee Name</label>
          <input type="name" class="form-control" id="name" aria-describedby="emailHelp">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Role</label>
          <input type="name" class="form-control" id="role">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Start Date (DD/MM/YY - ex: 01/01/89)</label>
          <input type="name" class="form-control" id="startDate">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Monthly Rate</label>
          <input type="name" class="form-control" id="monthlyRate">
        </div>
        <button type="submit" class="btn btn-primary" id="submit">Submit</button>
      </form>
      </div>
    </div>
  </div>

    
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>

    var config = {
      apiKey: "AIzaSyA_JqtyyoBzu84Dljy-m3icUzU-AEBOms0",
      authDomain: "test-project-836d4.firebaseapp.com",
      databaseURL: "https://test-project-836d4.firebaseio.com",
      projectId: "test-project-836d4",
      storageBucket: "test-project-836d4.appspot.com",
      messagingSenderId: "986425670124"
    };

  firebase.initializeApp(config);
  var database = firebase.database();




// Assign the reference to the database to a variable named 'database'




$("#submit").on("click", function(event) {

  event.preventDefault();

  var name = $('#name').val().trim();
  var role = $('#role').val().trim();
  var start = $('#startDate').val().trim();
  var rate = $('#monthlyRate').val().trim();

      database.ref().push({
        name : name,
        role : role,
        startDate : start,
        rate : rate
      });
    });

  database.ref().on("child_added", function(childSnapshot) {


    var newName = childSnapshot.val().name;
    var newRole = childSnapshot.val().role;
    var newStart = childSnapshot.val().startDate;
    var newRate = childSnapshot.val().rate;

    console.log(newName);
    console.log(newRole);
    console.log(newStart);
    console.log(newRate);


    var newRow = $('<tr>');

    $('#first').text(newName);
    $('#second').text(newRole);
    $('#third').text(newStart);
    $('#five').text(newRate);


    var now = new Date();
console.log(now.toString().substr(16,8));



      var timepretty = moment.unix(ttime).format("HH:mm");
      var trtime = moment().diff(moment.unix(ttime, "X"), "HH:mm");
      var divided = trtime / tfrequency;
      console.log("here is trtime " + divided);
      var firstTimeConverted = moment(ttime, "hh:mm").subtract(1, "years");
    console.log(firstTimeConverted);
      var diffTime = moment().diff(moment(firstTimeConverted), "minutes");
    console.log("DIFFERENCE IN TIME: " + diffTime);
    // Time apart (remainder)
    var tRemainder = diffTime % tfrequency;
    console.log("Remainder: " + tRemainder);
    // Minutes Away
    var minutesAway = tfrequency - tRemainder;
    console.log("MINUTES TILL TRAIN: " + minutesAway);
    // Next Train Arrival
    var nextArrival = moment().add(minutesAway, "minutes").format("HH:mm");
    console.log("ARRIVAL TIME: " + moment(nextArrival).format("HH:mm"));

    $("#employee-table > tbody").append("<tr><td>" + tname + "</td><td>" + tdestination + "</td><td>" +
  timepretty + "</td><td>" + tfrequency + "</td><td>" + nextArrival + "</td><td>" + minutesAway + "</td></tr>");

  });


  </script>
</body>

</html>